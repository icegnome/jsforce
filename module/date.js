"use strict";

var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js-stable/object/define-property");

require("core-js/modules/es.array.join");

require("core-js/modules/es.date.to-json");

require("core-js/modules/es.date.to-string");

require("core-js/modules/es.regexp.exec");

require("core-js/modules/es.string.match");

require("core-js/modules/web.url.to-json");

_Object$defineProperty(exports, "__esModule", {
  value: true
});

exports["default"] = void 0;

var _parseInt2 = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/parse-int"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime-corejs3/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime-corejs3/helpers/createClass"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime-corejs3/helpers/defineProperty"));

var _concat = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/concat"));

var _formatter = require("./util/formatter");

/**
 *
 */

/** @private **/
function createLiteralBuilder(literal) {
  return function (num) {
    var _context;

    return new SfDate((0, _concat["default"])(_context = "".concat(literal, ":")).call(_context, String(num)));
  }; // eslint-disable-line no-use-before-define
}
/**
 * A date object to keep Salesforce date literal
 *
 * @class
 * @constructor
 * @see http://www.salesforce.com/us/developer/docs/soql_sosl/Content/sforce_api_calls_soql_select_dateformats.htm
 */


var SfDate = /*#__PURE__*/function () {
  /**
   *
   */
  function SfDate(literal) {
    (0, _classCallCheck2["default"])(this, SfDate);
    (0, _defineProperty2["default"])(this, "_literal", void 0);
    (0, _defineProperty2["default"])(this, "toString", this.toJSON);
    this._literal = literal;
  }
  /**
   * Returns literal when converted to string
   */


  (0, _createClass2["default"])(SfDate, [{
    key: "toJSON",
    value: function toJSON() {
      return this._literal;
    }
  }], [{
    key: "toDateLiteral",

    /**
     * Convert JavaScript date object to ISO8601 Date format (e.g. 2012-10-31)
     *
     * @param {String|Number|Date} date - Input date
     * @returns {SfDate} - Salesforce date literal with ISO8601 date format
     */
    value: function toDateLiteral(date) {
      var _date;

      if (typeof date === 'number') {
        _date = new Date(date);
      } else if (typeof date === 'string') {
        _date = SfDate.parseDate(date);
      } else {
        _date = date;
      }

      var yy = _date.getFullYear();

      var mm = _date.getMonth() + 1;

      var dd = _date.getDate();

      var dstr = [yy, (0, _formatter.zeroPad)(mm), (0, _formatter.zeroPad)(dd)].join('-');
      return new SfDate(dstr);
    }
    /**
     * Convert JavaScript date object to ISO8601 DateTime format
     * (e.g. 2012-10-31T12:34:56Z)
     */

  }, {
    key: "toDateTimeLiteral",
    value: function toDateTimeLiteral(date) {
      var _context2;

      var _date;

      if (typeof date === 'number') {
        _date = new Date(date);
      } else if (typeof date === 'string') {
        _date = SfDate.parseDate(date);
      } else {
        _date = date;
      }

      var yy = _date.getUTCFullYear();

      var mm = _date.getUTCMonth() + 1;

      var dd = _date.getUTCDate();

      var hh = _date.getUTCHours();

      var mi = _date.getUTCMinutes();

      var ss = _date.getUTCSeconds();

      var dtstr = (0, _concat["default"])(_context2 = "".concat([yy, (0, _formatter.zeroPad)(mm), (0, _formatter.zeroPad)(dd)].join('-'), "T")).call(_context2, [(0, _formatter.zeroPad)(hh), (0, _formatter.zeroPad)(mi), (0, _formatter.zeroPad)(ss)].join(':'), "Z");
      return new SfDate(dtstr);
    }
    /**
     * Convert JavaScript date object to ISO8601 time format
     * (e.g. 12:34:56.789Z)
     */

  }, {
    key: "toTimeLiteral",
    value: function toTimeLiteral(time) {
      var _context3, _context4, _context5;

      var _date = new Date(0);

      if (typeof time === 'string') {
        _date = SfDate.parseTime(time);
      } else if (typeof time === 'number') {
        _date = new Date(time);
      } else {
        _date = time;
      }

      var hh = _date.getUTCHours();

      var mi = _date.getUTCMinutes();

      var ss = _date.getUTCSeconds();

      var sss = _date.getUTCMilliseconds();

      var tstr = (0, _concat["default"])(_context3 = (0, _concat["default"])(_context4 = (0, _concat["default"])(_context5 = "".concat((0, _formatter.zeroPad)(hh), ":")).call(_context5, (0, _formatter.zeroPad)(mi), ":")).call(_context4, (0, _formatter.zeroPad)(ss), ".")).call(_context3, (0, _formatter.zeroPad)(sss, 3), "Z");
      return new SfDate(tstr);
    }
    /**
     * Parse IS08601 date(time) formatted string and return date instance
     */

  }, {
    key: "parseDate",
    value: function parseDate(str) {
      var d = new Date();
      var regexp = /^([\d]{4})-?([\d]{2})-?([\d]{2})(T([\d]{2}):?([\d]{2}):?([\d]{2})(.([\d]{3}))?(Z|([+-])([\d]{2}):?([\d]{2})))?$/;
      var m = str.match(regexp);

      if (m) {
        d = new Date(0);

        if (!m[4]) {
          d.setFullYear((0, _parseInt2["default"])(m[1], 10));
          d.setDate((0, _parseInt2["default"])(m[3], 10));
          d.setMonth((0, _parseInt2["default"])(m[2], 10) - 1);
          d.setHours(0);
          d.setMinutes(0);
          d.setSeconds(0);
          d.setMilliseconds(0);
        } else {
          d.setUTCFullYear((0, _parseInt2["default"])(m[1], 10));
          d.setUTCDate((0, _parseInt2["default"])(m[3], 10));
          d.setUTCMonth((0, _parseInt2["default"])(m[2], 10) - 1);
          d.setUTCHours((0, _parseInt2["default"])(m[5], 10));
          d.setUTCMinutes((0, _parseInt2["default"])(m[6], 10));
          d.setUTCSeconds((0, _parseInt2["default"])(m[7], 10));
          d.setUTCMilliseconds((0, _parseInt2["default"])(m[9] || '0', 10));

          if (m[10] && m[10] !== 'Z') {
            var offset = (0, _parseInt2["default"])(m[12], 10) * 60 + (0, _parseInt2["default"])(m[13], 10);
            d.setTime((m[11] === '+' ? -1 : 1) * offset * 60 * 1000 + d.getTime());
          }
        }

        return d;
      }

      throw new Error("Invalid date format is specified : ".concat(str));
    }
    /**
     * Parse IS08601 time formatted string and convert to parse string
     */

  }, {
    key: "parseTime",
    value: function parseTime(str) {
      var regexp = /^([\d]{2}):?([\d]{2}):?([\d]{2})(.([\d]{3}))?Z?$/;
      var m = str.match(regexp);

      if (m) {
        var d = new Date(0);
        var hh = (0, _parseInt2["default"])(m[1], 10);
        var mi = (0, _parseInt2["default"])(m[2], 10);
        var ss = (0, _parseInt2["default"])(m[3], 10);
        var sss = (0, _parseInt2["default"])(m[5] || '0', 10);
        d.setUTCHours(hh);
        d.setUTCMinutes(mi);
        d.setUTCSeconds(ss);
        d.setUTCMilliseconds(sss);
        return d;
      }

      throw new Error("Invalid time format is specified : ".concat(str));
    }
  }]);
  return SfDate;
}();

exports["default"] = SfDate;
(0, _defineProperty2["default"])(SfDate, "YESTERDAY", new SfDate('YESTERDAY'));
(0, _defineProperty2["default"])(SfDate, "TODAY", new SfDate('TODAY'));
(0, _defineProperty2["default"])(SfDate, "TOMORROW", new SfDate('TOMORROW'));
(0, _defineProperty2["default"])(SfDate, "LAST_WEEK", new SfDate('LAST_WEEK'));
(0, _defineProperty2["default"])(SfDate, "THIS_WEEK", new SfDate('THIS_WEEK'));
(0, _defineProperty2["default"])(SfDate, "NEXT_WEEK", new SfDate('NEXT_WEEK'));
(0, _defineProperty2["default"])(SfDate, "LAST_MONTH", new SfDate('LAST_MONTH'));
(0, _defineProperty2["default"])(SfDate, "THIS_MONTH", new SfDate('THIS_MONTH'));
(0, _defineProperty2["default"])(SfDate, "NEXT_MONTH", new SfDate('NEXT_MONTH'));
(0, _defineProperty2["default"])(SfDate, "LAST_90_DAYS", new SfDate('LAST_90_DAYS'));
(0, _defineProperty2["default"])(SfDate, "NEXT_90_DAYS", new SfDate('NEXT_90_DAYS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_DAYS", createLiteralBuilder('LAST_N_DAYS'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_DAYS", createLiteralBuilder('NEXT_N_DAYS'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_WEEKS", createLiteralBuilder('NEXT_N_WEEKS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_WEEKS", createLiteralBuilder('LAST_N_WEEKS'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_MONTHS", createLiteralBuilder('NEXT_N_MONTHS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_MONTHS", createLiteralBuilder('LAST_N_MONTHS'));
(0, _defineProperty2["default"])(SfDate, "THIS_QUARTER", new SfDate('THIS_QUARTER'));
(0, _defineProperty2["default"])(SfDate, "LAST_QUARTER", new SfDate('LAST_QUARTER'));
(0, _defineProperty2["default"])(SfDate, "NEXT_QUARTER", new SfDate('NEXT_QUARTER'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_QUARTERS", createLiteralBuilder('NEXT_N_QUARTERS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_QUARTERS", createLiteralBuilder('LAST_N_QUARTERS'));
(0, _defineProperty2["default"])(SfDate, "THIS_YEAR", new SfDate('THIS_YEAR'));
(0, _defineProperty2["default"])(SfDate, "LAST_YEAR", new SfDate('LAST_YEAR'));
(0, _defineProperty2["default"])(SfDate, "NEXT_YEAR", new SfDate('NEXT_YEAR'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_YEARS", createLiteralBuilder('NEXT_N_YEARS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_YEARS", createLiteralBuilder('LAST_N_YEARS'));
(0, _defineProperty2["default"])(SfDate, "THIS_FISCAL_QUARTER", new SfDate('THIS_FISCAL_QUARTER'));
(0, _defineProperty2["default"])(SfDate, "LAST_FISCAL_QUARTER", new SfDate('LAST_FISCAL_QUARTER'));
(0, _defineProperty2["default"])(SfDate, "NEXT_FISCAL_QUARTER", new SfDate('NEXT_FISCAL_QUARTER'));
(0, _defineProperty2["default"])(SfDate, "THIS_FISCAL_YEAR", new SfDate('THIS_FISCAL_YEAR'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_FISCAL_QUARTERS", createLiteralBuilder('NEXT_N_FISCAL_QUARTERS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_FISCAL_QUARTERS", createLiteralBuilder('LAST_N_FISCAL_QUARTERS'));
(0, _defineProperty2["default"])(SfDate, "LAST_FISCAL_YEAR", new SfDate('LAST_FISCAL_YEAR'));
(0, _defineProperty2["default"])(SfDate, "NEXT_FISCAL_YEAR", new SfDate('NEXT_FISCAL_YEAR'));
(0, _defineProperty2["default"])(SfDate, "NEXT_N_FISCAL_YEARS", createLiteralBuilder('NEXT_N_FISCAL_YEARS'));
(0, _defineProperty2["default"])(SfDate, "LAST_N_FISCAL_YEARS", createLiteralBuilder('LAST_N_FISCAL_YEARS'));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kYXRlLnRzIl0sIm5hbWVzIjpbImNyZWF0ZUxpdGVyYWxCdWlsZGVyIiwibGl0ZXJhbCIsIm51bSIsIlNmRGF0ZSIsIlN0cmluZyIsInRvSlNPTiIsIl9saXRlcmFsIiwiZGF0ZSIsIl9kYXRlIiwiRGF0ZSIsInBhcnNlRGF0ZSIsInl5IiwiZ2V0RnVsbFllYXIiLCJtbSIsImdldE1vbnRoIiwiZGQiLCJnZXREYXRlIiwiZHN0ciIsImpvaW4iLCJnZXRVVENGdWxsWWVhciIsImdldFVUQ01vbnRoIiwiZ2V0VVRDRGF0ZSIsImhoIiwiZ2V0VVRDSG91cnMiLCJtaSIsImdldFVUQ01pbnV0ZXMiLCJzcyIsImdldFVUQ1NlY29uZHMiLCJkdHN0ciIsInRpbWUiLCJwYXJzZVRpbWUiLCJzc3MiLCJnZXRVVENNaWxsaXNlY29uZHMiLCJ0c3RyIiwic3RyIiwiZCIsInJlZ2V4cCIsIm0iLCJtYXRjaCIsInNldEZ1bGxZZWFyIiwic2V0RGF0ZSIsInNldE1vbnRoIiwic2V0SG91cnMiLCJzZXRNaW51dGVzIiwic2V0U2Vjb25kcyIsInNldE1pbGxpc2Vjb25kcyIsInNldFVUQ0Z1bGxZZWFyIiwic2V0VVRDRGF0ZSIsInNldFVUQ01vbnRoIiwic2V0VVRDSG91cnMiLCJzZXRVVENNaW51dGVzIiwic2V0VVRDU2Vjb25kcyIsInNldFVUQ01pbGxpc2Vjb25kcyIsIm9mZnNldCIsInNldFRpbWUiLCJnZXRUaW1lIiwiRXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHQTs7QUFIQTtBQUNBO0FBQ0E7O0FBR0E7QUFDQSxTQUFTQSxvQkFBVCxDQUE4QkMsT0FBOUIsRUFBK0M7QUFDN0MsU0FBTyxVQUFDQyxHQUFEO0FBQUE7O0FBQUEsV0FBaUIsSUFBSUMsTUFBSiw4Q0FBY0YsT0FBZCx1QkFBeUJHLE1BQU0sQ0FBQ0YsR0FBRCxDQUEvQixFQUFqQjtBQUFBLEdBQVAsQ0FENkMsQ0FDb0I7QUFDbEU7QUFF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eEJHLE0sa0JBdUtHLElBQUlBLE1BQUosQ0FBVyxjQUFYLEM7aUNBdktIQSxNLGtCQXdLRyxJQUFJQSxNQUFKLENBQVcsY0FBWCxDO2lDQXhLSEEsTSxrQkF5S0csSUFBSUEsTUFBSixDQUFXLGNBQVgsQztpQ0F6S0hBLE0scUJBMEtNSCxvQkFBb0IsQ0FBQyxpQkFBRCxDO2lDQTFLMUJHLE0scUJBMktNSCxvQkFBb0IsQ0FBQyxpQkFBRCxDO2lDQTNLMUJHLE0sZUE0S0EsSUFBSUEsTUFBSixDQUFXLFdBQVgsQztpQ0E1S0FBLE0sZUE2S0EsSUFBSUEsTUFBSixDQUFXLFdBQVgsQztpQ0E3S0FBLE0sZUE4S0EsSUFBSUEsTUFBSixDQUFXLFdBQVgsQztpQ0E5S0FBLE0sa0JBK0tHSCxvQkFBb0IsQ0FBQyxjQUFELEM7aUNBL0t2QkcsTSxrQkFnTEdILG9CQUFvQixDQUFDLGNBQUQsQztpQ0FoTHZCRyxNLHlCQWlMVSxJQUFJQSxNQUFKLENBQVcscUJBQVgsQztpQ0FqTFZBLE0seUJBa0xVLElBQUlBLE1BQUosQ0FBVyxxQkFBWCxDO2lDQWxMVkEsTSx5QkFtTFUsSUFBSUEsTUFBSixDQUFXLHFCQUFYLEM7aUNBbkxWQSxNLHNCQW9MTyxJQUFJQSxNQUFKLENBQVcsa0JBQVgsQztpQ0FwTFBBLE0sNEJBcUxhSCxvQkFBb0IsQ0FDbEQsd0JBRGtELEM7aUNBckxqQ0csTSw0QkF3TGFILG9CQUFvQixDQUNsRCx3QkFEa0QsQztpQ0F4TGpDRyxNLHNCQTJMTyxJQUFJQSxNQUFKLENBQVcsa0JBQVgsQztpQ0EzTFBBLE0sc0JBNExPLElBQUlBLE1BQUosQ0FBVyxrQkFBWCxDO2lDQTVMUEEsTSx5QkE2TFVILG9CQUFvQixDQUFDLHFCQUFELEM7aUNBN0w5QkcsTSx5QkE4TFVILG9CQUFvQixDQUFDLHFCQUFELEMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICpcclxuICovXHJcbmltcG9ydCB7IHplcm9QYWQgfSBmcm9tICcuL3V0aWwvZm9ybWF0dGVyJztcclxuXHJcbi8qKiBAcHJpdmF0ZSAqKi9cclxuZnVuY3Rpb24gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIobGl0ZXJhbDogc3RyaW5nKSB7XHJcbiAgcmV0dXJuIChudW06IG51bWJlcikgPT4gbmV3IFNmRGF0ZShgJHtsaXRlcmFsfToke1N0cmluZyhudW0pfWApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVzZS1iZWZvcmUtZGVmaW5lXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIGRhdGUgb2JqZWN0IHRvIGtlZXAgU2FsZXNmb3JjZSBkYXRlIGxpdGVyYWxcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAc2VlIGh0dHA6Ly93d3cuc2FsZXNmb3JjZS5jb20vdXMvZGV2ZWxvcGVyL2RvY3Mvc29xbF9zb3NsL0NvbnRlbnQvc2ZvcmNlX2FwaV9jYWxsc19zb3FsX3NlbGVjdF9kYXRlZm9ybWF0cy5odG1cclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNmRGF0ZSB7XHJcbiAgcHJpdmF0ZSBfbGl0ZXJhbDogc3RyaW5nO1xyXG5cclxuICAvKipcclxuICAgKlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKGxpdGVyYWw6IHN0cmluZykge1xyXG4gICAgdGhpcy5fbGl0ZXJhbCA9IGxpdGVyYWw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGxpdGVyYWwgd2hlbiBjb252ZXJ0ZWQgdG8gc3RyaW5nXHJcbiAgICovXHJcbiAgdG9KU09OKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpdGVyYWw7XHJcbiAgfVxyXG5cclxuICB0b1N0cmluZyA9IHRoaXMudG9KU09OO1xyXG5cclxuICAvKipcclxuICAgKiBDb252ZXJ0IEphdmFTY3JpcHQgZGF0ZSBvYmplY3QgdG8gSVNPODYwMSBEYXRlIGZvcm1hdCAoZS5nLiAyMDEyLTEwLTMxKVxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtTdHJpbmd8TnVtYmVyfERhdGV9IGRhdGUgLSBJbnB1dCBkYXRlXHJcbiAgICogQHJldHVybnMge1NmRGF0ZX0gLSBTYWxlc2ZvcmNlIGRhdGUgbGl0ZXJhbCB3aXRoIElTTzg2MDEgZGF0ZSBmb3JtYXRcclxuICAgKi9cclxuICBzdGF0aWMgdG9EYXRlTGl0ZXJhbChkYXRlOiBzdHJpbmcgfCBudW1iZXIgfCBEYXRlKSB7XHJcbiAgICBsZXQgX2RhdGU6IERhdGU7XHJcbiAgICBpZiAodHlwZW9mIGRhdGUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgIF9kYXRlID0gbmV3IERhdGUoZGF0ZSk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRlID09PSAnc3RyaW5nJykge1xyXG4gICAgICBfZGF0ZSA9IFNmRGF0ZS5wYXJzZURhdGUoZGF0ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfZGF0ZSA9IGRhdGU7XHJcbiAgICB9XHJcbiAgICBjb25zdCB5eSA9IF9kYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICBjb25zdCBtbSA9IF9kYXRlLmdldE1vbnRoKCkgKyAxO1xyXG4gICAgY29uc3QgZGQgPSBfZGF0ZS5nZXREYXRlKCk7XHJcbiAgICBjb25zdCBkc3RyID0gW3l5LCB6ZXJvUGFkKG1tKSwgemVyb1BhZChkZCldLmpvaW4oJy0nKTtcclxuICAgIHJldHVybiBuZXcgU2ZEYXRlKGRzdHIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29udmVydCBKYXZhU2NyaXB0IGRhdGUgb2JqZWN0IHRvIElTTzg2MDEgRGF0ZVRpbWUgZm9ybWF0XHJcbiAgICogKGUuZy4gMjAxMi0xMC0zMVQxMjozNDo1NlopXHJcbiAgICovXHJcbiAgc3RhdGljIHRvRGF0ZVRpbWVMaXRlcmFsKGRhdGU6IHN0cmluZyB8IG51bWJlciB8IERhdGUpIHtcclxuICAgIGxldCBfZGF0ZTogRGF0ZTtcclxuICAgIGlmICh0eXBlb2YgZGF0ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgX2RhdGUgPSBuZXcgRGF0ZShkYXRlKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIF9kYXRlID0gU2ZEYXRlLnBhcnNlRGF0ZShkYXRlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF9kYXRlID0gZGF0ZTtcclxuICAgIH1cclxuICAgIGNvbnN0IHl5ID0gX2RhdGUuZ2V0VVRDRnVsbFllYXIoKTtcclxuICAgIGNvbnN0IG1tID0gX2RhdGUuZ2V0VVRDTW9udGgoKSArIDE7XHJcbiAgICBjb25zdCBkZCA9IF9kYXRlLmdldFVUQ0RhdGUoKTtcclxuICAgIGNvbnN0IGhoID0gX2RhdGUuZ2V0VVRDSG91cnMoKTtcclxuICAgIGNvbnN0IG1pID0gX2RhdGUuZ2V0VVRDTWludXRlcygpO1xyXG4gICAgY29uc3Qgc3MgPSBfZGF0ZS5nZXRVVENTZWNvbmRzKCk7XHJcbiAgICBjb25zdCBkdHN0ciA9IGAke1t5eSwgemVyb1BhZChtbSksIHplcm9QYWQoZGQpXS5qb2luKCctJyl9VCR7W1xyXG4gICAgICB6ZXJvUGFkKGhoKSxcclxuICAgICAgemVyb1BhZChtaSksXHJcbiAgICAgIHplcm9QYWQoc3MpLFxyXG4gICAgXS5qb2luKCc6Jyl9WmA7XHJcbiAgICByZXR1cm4gbmV3IFNmRGF0ZShkdHN0cik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb252ZXJ0IEphdmFTY3JpcHQgZGF0ZSBvYmplY3QgdG8gSVNPODYwMSB0aW1lIGZvcm1hdFxyXG4gICAqIChlLmcuIDEyOjM0OjU2Ljc4OVopXHJcbiAgICovXHJcbiAgc3RhdGljIHRvVGltZUxpdGVyYWwodGltZTogc3RyaW5nIHwgbnVtYmVyIHwgRGF0ZSkge1xyXG4gICAgbGV0IF9kYXRlID0gbmV3IERhdGUoMCk7XHJcbiAgICBpZiAodHlwZW9mIHRpbWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIF9kYXRlID0gU2ZEYXRlLnBhcnNlVGltZSh0aW1lKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRpbWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgIF9kYXRlID0gbmV3IERhdGUodGltZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfZGF0ZSA9IHRpbWU7XHJcbiAgICB9XHJcbiAgICBjb25zdCBoaCA9IF9kYXRlLmdldFVUQ0hvdXJzKCk7XHJcbiAgICBjb25zdCBtaSA9IF9kYXRlLmdldFVUQ01pbnV0ZXMoKTtcclxuICAgIGNvbnN0IHNzID0gX2RhdGUuZ2V0VVRDU2Vjb25kcygpO1xyXG4gICAgY29uc3Qgc3NzID0gX2RhdGUuZ2V0VVRDTWlsbGlzZWNvbmRzKCk7XHJcbiAgICBjb25zdCB0c3RyID0gYCR7emVyb1BhZChoaCl9OiR7emVyb1BhZChtaSl9OiR7emVyb1BhZChzcyl9LiR7emVyb1BhZChcclxuICAgICAgc3NzLFxyXG4gICAgICAzLFxyXG4gICAgKX1aYDtcclxuICAgIHJldHVybiBuZXcgU2ZEYXRlKHRzdHIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUGFyc2UgSVMwODYwMSBkYXRlKHRpbWUpIGZvcm1hdHRlZCBzdHJpbmcgYW5kIHJldHVybiBkYXRlIGluc3RhbmNlXHJcbiAgICovXHJcbiAgc3RhdGljIHBhcnNlRGF0ZShzdHI6IHN0cmluZyk6IERhdGUge1xyXG4gICAgbGV0IGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgcmVnZXhwID0gL14oW1xcZF17NH0pLT8oW1xcZF17Mn0pLT8oW1xcZF17Mn0pKFQoW1xcZF17Mn0pOj8oW1xcZF17Mn0pOj8oW1xcZF17Mn0pKC4oW1xcZF17M30pKT8oWnwoWystXSkoW1xcZF17Mn0pOj8oW1xcZF17Mn0pKSk/JC87XHJcbiAgICBjb25zdCBtID0gc3RyLm1hdGNoKHJlZ2V4cCk7XHJcbiAgICBpZiAobSkge1xyXG4gICAgICBkID0gbmV3IERhdGUoMCk7XHJcbiAgICAgIGlmICghbVs0XSkge1xyXG4gICAgICAgIGQuc2V0RnVsbFllYXIocGFyc2VJbnQobVsxXSwgMTApKTtcclxuICAgICAgICBkLnNldERhdGUocGFyc2VJbnQobVszXSwgMTApKTtcclxuICAgICAgICBkLnNldE1vbnRoKHBhcnNlSW50KG1bMl0sIDEwKSAtIDEpO1xyXG4gICAgICAgIGQuc2V0SG91cnMoMCk7XHJcbiAgICAgICAgZC5zZXRNaW51dGVzKDApO1xyXG4gICAgICAgIGQuc2V0U2Vjb25kcygwKTtcclxuICAgICAgICBkLnNldE1pbGxpc2Vjb25kcygwKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBkLnNldFVUQ0Z1bGxZZWFyKHBhcnNlSW50KG1bMV0sIDEwKSk7XHJcbiAgICAgICAgZC5zZXRVVENEYXRlKHBhcnNlSW50KG1bM10sIDEwKSk7XHJcbiAgICAgICAgZC5zZXRVVENNb250aChwYXJzZUludChtWzJdLCAxMCkgLSAxKTtcclxuICAgICAgICBkLnNldFVUQ0hvdXJzKHBhcnNlSW50KG1bNV0sIDEwKSk7XHJcbiAgICAgICAgZC5zZXRVVENNaW51dGVzKHBhcnNlSW50KG1bNl0sIDEwKSk7XHJcbiAgICAgICAgZC5zZXRVVENTZWNvbmRzKHBhcnNlSW50KG1bN10sIDEwKSk7XHJcbiAgICAgICAgZC5zZXRVVENNaWxsaXNlY29uZHMocGFyc2VJbnQobVs5XSB8fCAnMCcsIDEwKSk7XHJcbiAgICAgICAgaWYgKG1bMTBdICYmIG1bMTBdICE9PSAnWicpIHtcclxuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IHBhcnNlSW50KG1bMTJdLCAxMCkgKiA2MCArIHBhcnNlSW50KG1bMTNdLCAxMCk7XHJcbiAgICAgICAgICBkLnNldFRpbWUoXHJcbiAgICAgICAgICAgIChtWzExXSA9PT0gJysnID8gLTEgOiAxKSAqIG9mZnNldCAqIDYwICogMTAwMCArIGQuZ2V0VGltZSgpLFxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGQ7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZGF0ZSBmb3JtYXQgaXMgc3BlY2lmaWVkIDogJHtzdHJ9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQYXJzZSBJUzA4NjAxIHRpbWUgZm9ybWF0dGVkIHN0cmluZyBhbmQgY29udmVydCB0byBwYXJzZSBzdHJpbmdcclxuICAgKi9cclxuICBzdGF0aWMgcGFyc2VUaW1lKHN0cjogc3RyaW5nKTogRGF0ZSB7XHJcbiAgICBjb25zdCByZWdleHAgPSAvXihbXFxkXXsyfSk6PyhbXFxkXXsyfSk6PyhbXFxkXXsyfSkoLihbXFxkXXszfSkpP1o/JC87XHJcbiAgICBjb25zdCBtID0gc3RyLm1hdGNoKHJlZ2V4cCk7XHJcbiAgICBpZiAobSkge1xyXG4gICAgICBjb25zdCBkID0gbmV3IERhdGUoMCk7XHJcbiAgICAgIGxldCBoaCA9IHBhcnNlSW50KG1bMV0sIDEwKTtcclxuICAgICAgY29uc3QgbWkgPSBwYXJzZUludChtWzJdLCAxMCk7XHJcbiAgICAgIGNvbnN0IHNzID0gcGFyc2VJbnQobVszXSwgMTApO1xyXG4gICAgICBjb25zdCBzc3MgPSBwYXJzZUludChtWzVdIHx8ICcwJywgMTApO1xyXG4gICAgICBkLnNldFVUQ0hvdXJzKGhoKTtcclxuICAgICAgZC5zZXRVVENNaW51dGVzKG1pKTtcclxuICAgICAgZC5zZXRVVENTZWNvbmRzKHNzKTtcclxuICAgICAgZC5zZXRVVENNaWxsaXNlY29uZHMoc3NzKTtcclxuICAgICAgcmV0dXJuIGQ7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdGltZSBmb3JtYXQgaXMgc3BlY2lmaWVkIDogJHtzdHJ9YCk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgWUVTVEVSREFZID0gbmV3IFNmRGF0ZSgnWUVTVEVSREFZJyk7XHJcbiAgc3RhdGljIFRPREFZID0gbmV3IFNmRGF0ZSgnVE9EQVknKTtcclxuICBzdGF0aWMgVE9NT1JST1cgPSBuZXcgU2ZEYXRlKCdUT01PUlJPVycpO1xyXG4gIHN0YXRpYyBMQVNUX1dFRUsgPSBuZXcgU2ZEYXRlKCdMQVNUX1dFRUsnKTtcclxuICBzdGF0aWMgVEhJU19XRUVLID0gbmV3IFNmRGF0ZSgnVEhJU19XRUVLJyk7XHJcbiAgc3RhdGljIE5FWFRfV0VFSyA9IG5ldyBTZkRhdGUoJ05FWFRfV0VFSycpO1xyXG4gIHN0YXRpYyBMQVNUX01PTlRIID0gbmV3IFNmRGF0ZSgnTEFTVF9NT05USCcpO1xyXG4gIHN0YXRpYyBUSElTX01PTlRIID0gbmV3IFNmRGF0ZSgnVEhJU19NT05USCcpO1xyXG4gIHN0YXRpYyBORVhUX01PTlRIID0gbmV3IFNmRGF0ZSgnTkVYVF9NT05USCcpO1xyXG4gIHN0YXRpYyBMQVNUXzkwX0RBWVMgPSBuZXcgU2ZEYXRlKCdMQVNUXzkwX0RBWVMnKTtcclxuICBzdGF0aWMgTkVYVF85MF9EQVlTID0gbmV3IFNmRGF0ZSgnTkVYVF85MF9EQVlTJyk7XHJcbiAgc3RhdGljIExBU1RfTl9EQVlTID0gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIoJ0xBU1RfTl9EQVlTJyk7XHJcbiAgc3RhdGljIE5FWFRfTl9EQVlTID0gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIoJ05FWFRfTl9EQVlTJyk7XHJcbiAgc3RhdGljIE5FWFRfTl9XRUVLUyA9IGNyZWF0ZUxpdGVyYWxCdWlsZGVyKCdORVhUX05fV0VFS1MnKTtcclxuICBzdGF0aWMgTEFTVF9OX1dFRUtTID0gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIoJ0xBU1RfTl9XRUVLUycpO1xyXG4gIHN0YXRpYyBORVhUX05fTU9OVEhTID0gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIoJ05FWFRfTl9NT05USFMnKTtcclxuICBzdGF0aWMgTEFTVF9OX01PTlRIUyA9IGNyZWF0ZUxpdGVyYWxCdWlsZGVyKCdMQVNUX05fTU9OVEhTJyk7XHJcbiAgc3RhdGljIFRISVNfUVVBUlRFUiA9IG5ldyBTZkRhdGUoJ1RISVNfUVVBUlRFUicpO1xyXG4gIHN0YXRpYyBMQVNUX1FVQVJURVIgPSBuZXcgU2ZEYXRlKCdMQVNUX1FVQVJURVInKTtcclxuICBzdGF0aWMgTkVYVF9RVUFSVEVSID0gbmV3IFNmRGF0ZSgnTkVYVF9RVUFSVEVSJyk7XHJcbiAgc3RhdGljIE5FWFRfTl9RVUFSVEVSUyA9IGNyZWF0ZUxpdGVyYWxCdWlsZGVyKCdORVhUX05fUVVBUlRFUlMnKTtcclxuICBzdGF0aWMgTEFTVF9OX1FVQVJURVJTID0gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIoJ0xBU1RfTl9RVUFSVEVSUycpO1xyXG4gIHN0YXRpYyBUSElTX1lFQVIgPSBuZXcgU2ZEYXRlKCdUSElTX1lFQVInKTtcclxuICBzdGF0aWMgTEFTVF9ZRUFSID0gbmV3IFNmRGF0ZSgnTEFTVF9ZRUFSJyk7XHJcbiAgc3RhdGljIE5FWFRfWUVBUiA9IG5ldyBTZkRhdGUoJ05FWFRfWUVBUicpO1xyXG4gIHN0YXRpYyBORVhUX05fWUVBUlMgPSBjcmVhdGVMaXRlcmFsQnVpbGRlcignTkVYVF9OX1lFQVJTJyk7XHJcbiAgc3RhdGljIExBU1RfTl9ZRUFSUyA9IGNyZWF0ZUxpdGVyYWxCdWlsZGVyKCdMQVNUX05fWUVBUlMnKTtcclxuICBzdGF0aWMgVEhJU19GSVNDQUxfUVVBUlRFUiA9IG5ldyBTZkRhdGUoJ1RISVNfRklTQ0FMX1FVQVJURVInKTtcclxuICBzdGF0aWMgTEFTVF9GSVNDQUxfUVVBUlRFUiA9IG5ldyBTZkRhdGUoJ0xBU1RfRklTQ0FMX1FVQVJURVInKTtcclxuICBzdGF0aWMgTkVYVF9GSVNDQUxfUVVBUlRFUiA9IG5ldyBTZkRhdGUoJ05FWFRfRklTQ0FMX1FVQVJURVInKTtcclxuICBzdGF0aWMgVEhJU19GSVNDQUxfWUVBUiA9IG5ldyBTZkRhdGUoJ1RISVNfRklTQ0FMX1lFQVInKTtcclxuICBzdGF0aWMgTkVYVF9OX0ZJU0NBTF9RVUFSVEVSUyA9IGNyZWF0ZUxpdGVyYWxCdWlsZGVyKFxyXG4gICAgJ05FWFRfTl9GSVNDQUxfUVVBUlRFUlMnLFxyXG4gICk7XHJcbiAgc3RhdGljIExBU1RfTl9GSVNDQUxfUVVBUlRFUlMgPSBjcmVhdGVMaXRlcmFsQnVpbGRlcihcclxuICAgICdMQVNUX05fRklTQ0FMX1FVQVJURVJTJyxcclxuICApO1xyXG4gIHN0YXRpYyBMQVNUX0ZJU0NBTF9ZRUFSID0gbmV3IFNmRGF0ZSgnTEFTVF9GSVNDQUxfWUVBUicpO1xyXG4gIHN0YXRpYyBORVhUX0ZJU0NBTF9ZRUFSID0gbmV3IFNmRGF0ZSgnTkVYVF9GSVNDQUxfWUVBUicpO1xyXG4gIHN0YXRpYyBORVhUX05fRklTQ0FMX1lFQVJTID0gY3JlYXRlTGl0ZXJhbEJ1aWxkZXIoJ05FWFRfTl9GSVNDQUxfWUVBUlMnKTtcclxuICBzdGF0aWMgTEFTVF9OX0ZJU0NBTF9ZRUFSUyA9IGNyZWF0ZUxpdGVyYWxCdWlsZGVyKCdMQVNUX05fRklTQ0FMX1lFQVJTJyk7XHJcbn1cclxuIl19